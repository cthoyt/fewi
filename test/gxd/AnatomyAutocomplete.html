<html xmlns:concordion="http://www.concordion.org/2007/concordion" xmlns:cc="http://fewi.custom.commands.FewiExtensions">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<style>
	table {border-collapse: collapse; padding-bottom:5px; margin-bottom:5px;}
	table, th, td {border: 1px solid #CCCCCC;}
	td, th {padding:2px;}
	.man {background-color:#FFFFCC;}
	ul {padding: 0px; padding-bottom:3px; padding-top:0px; margin: 0px;}
	ol {padding: 0px; padding-bottom:3px; padding-top:0px; margin: 0px;}
	li {padding-left:2px; padding-top:0px; padding-bottom:0px; margin-left:25px;}
	p {margin:2px 0px;}
</style>

<title>Anatomy Autocomplete Tests</title>
</head>
<body>

<div id="maintitle">
    <h1>Anatomy Autocomlete Tests</h1>
    <ul>
        <li>User story 10, Build autocomplete for Anatomy term search</li>
    </ul>
</div>

<div id="acceptance">
    <h2>Acceptance Criteria</h2>
	<ul>
		<li> input text causes a dropdown list to appear with matching structure and synonyms</li>
		<li> when the user selects a term, the input box is populated with the selected text</li>
		<li> sorting is by 
		score (exact matches first), then by alpha</li>
		<li> support string tokens (i.e. ""le lo"" includes ""left lobe"")</li>
		<li> does not support selecting multiple Structure Names</li>
	</ul>
</div>

<div id="tests">
    <h2>Tests</h2>
	<div id="manual">
		<h3>Manual tests</h3>
		<ol>
     		<li>Test that a structure when selected gets put into the input box
     		<p concordion:assertTrue="true">Passed jeffc 08/10/2012</p>
    		<ol>
                <li>open GXD query form and make sure anatomy field is clear</li>
				<li>type <b>brain</b> in the Anatomy field</li>
				<li>click on <b>brain</b> in the dropdown list</li>
				<li>verify that the <b>input box is populated with brain</b></li>
    		</ol>
    		</li>
    		<li>Test that a synonym when selected puts the synonym in the input box instead of synonym
    		<p concordion:assertTrue="true">Passed jeffc 08/10/2012</p><i>Note: this logic was changed during story #11 (Anatomy Term search)</i>
    		<ol>
                <li>open the GXD query form</li>
				<li>type <b>myocardium</b> into the Anatomy field</li>
				<li>click on <b>myocardium</b> in the dropdown</li>
				<li>verify that the <b>input box is populated with myocardium</b></li>
    		</ol>
    		</li>

    		<li>Test that autocomplete starts when you enter the second character
    		<p concordion:assertTrue="true">Passed jeffc 08/10/2012</p>
    		<ol>
                <li>open the GXD query form and clear the anatomy field</li>
				<li>type the character <b>b</b> in the anatomy field and wait a few seconds</li>
				<li>verify that no dropdown appears</li>
				<li>continue typing entering the character <b>r</b></li>
				<li>verify that <b>the dropdown list appears, and terms in the list contain words beginning with "br"</b></li>
    		</ol>
    		</li>
    		<li>Test that tokens are ANDed
    		<p concordion:assertTrue="true">Passed jeffc 08/10/2012</p>
    		<ol>
                <li>open the GXD query form and clear the anatomy field</li>
				<li>type <b>cardiac brain</b> in the anatomy field</li>
				<li>verify that <b>the dropdown appears after typing cardiac, but has disappeared by the time you finish typing brain</b></li>
    		</ol>
    		</li>
    		<li>Test that sorting of the autocomplete list is by exact match to a completed token, and then by smart-alpha
    		<p concordion:assertTrue="true">Passed jeffc 8/10/2012</p>
    		<ol>
                <li>open the GXD query form and clear the anatomy field</li>
				<li>type <b>epithel</b> in the anatomy field</li>
				<li>verify that <b>the dropdown list is presented in alphabetical order (case insensitive)</b></li>
				<li>complete typing <b>epithelium</b> in the anatomy field</li>
				<li>verify that <b>epithelium</b> is the first value in the dropdown list</li>
				<li>verify that two-token terms appear next in the list, in alphabetical order (case insensitive)</li>
				<li>verify that terms having 3 or more tokens appear after single- and two-token terms, and are in alphabetical order (case insensitive)</li> 
    		</ol>
    		</li>
		<li>Test reset button clears all fields
		    <p concordion:assertTrue="true">Passed jeffc 08/10/2012</p>
			<ol>
				<li>open the GXD query form and enter <b>text in the anatomy field and in the Nomen field</b></li>
				<li><b>Press the Reset button</b></li>
				<li>verify that <b>Anatomy text and Nomen text disappears</b></li>
			</ol>
		</li>
		<li>Test that special characters are treated as white space
    		<p concordion:assertTrue="true">Passed jeffc 08/10/2012</p>
		<ol>
                <li>open the GXD query form and clear the anatomy field</li>
				<li>type <b>cranio facial</b> in the anatomy field</li>
				<li>verify that <b>cranio-facial muscle</b> appears in the dropdown list</li>
				<li>type <b>vagus ganglion gasserian</b> in the anatomy field</li>
				<li>verify that <b>superior vagus ganglion, gasserian ganglion</b> appears in the dropdown list</li>
				<li>type <b>rathke s</b> in the anatomy field</li>
				<li>verify that <b>Rathke's pouch</b> appears in the dropdown list</li>
				<li>type <b>rathke's</b> in the anatomy field</li>
				<li>verify that <b>Rathke's pouch</b> appears in the dropdown list</li>
		</ol>
		</li>
		</ol>
	</div>
	<div id="auto">
		<h3>Automated tests</h3>
		<ol>
   		<li>Test the ID
    		<ol>
                <li>open GXD query form and make sure anatomy field is clear</li>
				<li>type <b concordion:set="#query">brain</b> in the Anatomy field</li>
				<li>verify that <b cc:assertAllResultsContainText="getTerms(#query)">brain</b> appears in every result in the dropdown list</li>
    		</ol>
    	</li>
    	<li>Test that a synonym when entered appears in the dropdown
    		<ol>
    			<li>open the GXD query form and make sure the anatomy field is clear</li>
				<li>type <b concordion:set="#query">myocardium</b> (a synonym of cardiac muscle) in to the Anatomy field</li>
				<li>verify that <b cc:assertValueAppearsOnlyOnce="getTerms(#query)">myocardium</b> appears in the dropdown</li>
    		</ol>
    	</li>
    	<li>Test that a term appears only once in the dropdown
    		<ol>
    			<li>open the GXD query form and clear the anatomy field</li>
				<li>Type <b concordion:set="#query">vein</b> in the anatomy field</li>
				<li>verify that <b cc:assertValueAppearsOnlyOnce="getTerms(#query)">vein</b> appears only once in the dropdown</li>
				<li>verify that <b cc:assertResultsContain="getTerms(#query)">vein</b> appears somewhere in the dropdown</li>
				<li>verify that <b cc:assertAllResultsContainText="getTerms(#query)">vein</b> appears in every result in the dropdown list</li>
    		</ol>
    	</li>
    	<li>Test finding a term that has a special character in it
    		<ol>
    			<li>open the GXD query form and clear the anatomy field</li>
				<li>type <b concordion:set="#query">4-cell stage embryo</b> in the Anatomy field</li>
				<li>verify that <b cc:assertValueAppearsOnlyOnce="getTerms(#query)">4-cell stage embryo</b> appears in the dropdown</li>
    		</ol>
    	</li>
    	<li>Test multiple tokens
    		<ol>
    			<li>open the GXD query form and clear the anatomy field</li>
				<li>type <b concordion:set="#query">renal cortex</b> in the anatomy field</li>
				<li><b cc:assertValueAppearsOnlyOnce="getTerms(#query)">renal cortex</b> should appear in the dropdown and not cortex or renal vascluature, etc</li>
    		</ol>
    	</li>
    	<li>Test multiple partial tokens
    		<ol>
    			<li>open the GXD query form and clear the anatomy field</li>
				<li>type <b concordion:set="#query">le lu</b> in the anatomy field</li>
				<li>verify that <b cc:assertValueAppearsOnlyOnce="getTerms(#query)">left lung</b> is in the dropdown</li>
    		</ol>
    	</li>
    	<li>Test that special characters do not break the anatomy field
    		<ol>
    			<li>open the GXD query form and clear the anatomy field</li>
				<li>type <b concordion:set="#query">****</b> in the anatomy field</li>
				<li>verify no dropdown should appear, indicating <b concordion:assertEquals="getTermCount(#query)">0</b> results.</li>
				<li>clear the anatomy field and type <b concordion:set="#query">?!@</b></li>
				<li>verify no dropdown should appear, indicating <b concordion:assertEquals="getTermCount(#query)">0</b> results.</li>
				<li>clear the anatomy field and type <b concordion:set="#query">(^)%$</b></li>
				<li>verify no dropdown should appear, indicating <b concordion:assertEquals="getTermCount(#query)">0</b> results.</li>
			</ol>
    	</li>
    	<li>Test that special characters are ignored between tokens
    		<ol>
    			<li>open the GXD query form and clear the anatomy field</li>
				<li>type <b concordion:set="#query">future*-*brain</b> in the anatomy field</li>
				<li><b cc:assertValueAppearsOnlyOnce="getTerms(#query)">future brain</b> should appear in the dropdown</li>
			</ol>
    	</li>
    	<li>Test that parent terms do not appear in dropdown
    		<ol>
    			<li>open the GXD query form and clear the anatomy field</li>
				<li>type <b concordion:set="#query">tongue</b> in the anatomy field</li>
				<li>verify that no parent term of tongue appears, such as 
					<b cc:assertNoResultsContain="getTerms(#query)">pharynx</b>,
					<b cc:assertNoResultsContain="getTerms(#query)">gut</b>,
					<b cc:assertNoResultsContain="getTerms(#query)">alimentary system</b>,
					<b cc:assertNoResultsContain="getTerms(#query)">visceral organ</b>,
					<b cc:assertNoResultsContain="getTerms(#query)">embryo</b>, etc</li>
    		</ol>
    	</li>
    	<li>Test that child terms do not appear in dropdown
    		<ol>
				<li>open the GXD query form and clear the anatomy field</li>
				<li>type <b concordion:set="#query">central nervous system</b> in the anatomy field</li>
				<li>verify that no child terms of central nervous system appear, such as 
					<b cc:assertNoResultsContain="getTerms(#query)">brain</b>,
					<b cc:assertNoResultsContain="getTerms(#query)">spinal chord</b>, etc</li>
			</ol>
    	</li>
    	<li>Test that autocomplete is not searching printnames
			<ol>
				<li>open the GXD query form and clear the anatomy field</li>
				<li>type <b concordion:set="#query">peripheral nervous system; autonomic; parasympathetic</b></li>
				<li>verify that no dropdown appears, indicating <b concordion:assertEquals="getTermCount(#query)">0</b> results.</li>
			</ol>
		</li>
		<li>Test the longest structure name
			<ol>
				<li>open the GXD query form and clear the anatomy field</li>
				<li>type <b concordion:set="#query">mesenchyme of paramesonephric duct of female, mesonephric portion</b> </li>
				<li>verify that <b cc:assertValueAppearsOnlyOnce="getTerms(#query)">mesenchyme of paramesonephric duct of female, mesonephric portion</b> does indeed appear in the dropdown</li>
			</ol>
		</li>
		<li>Test matching across fields does not occur
			<ol>
				<li>open the GXD query form and clear the anatomy field</li>
				<li>type <b concordion:set="#query">kidney metanephros</b> (a synonym followed by its base structure)</li>
				<li>verify that no dropdown appears, indicating <b concordion:assertEquals="getTermCount(#query)">0</b> results.</li>
			</ol>
		</li>
		</ol>
	</div>
</div>

</body>
</html>