<html xmlns:concordion="http://www.concordion.org/2007/concordion" xmlns:cc="http://fewi.custom.commands.FewiExtensions">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<style>
	table {border-collapse: collapse; padding-bottom:5px; margin-bottom:5px;}
	table, th, td {border: 1px solid #CCCCCC;}
	td, th {padding:2px;}
	.man {background-color:#FFFFCC;}
	ul {padding: 0px; padding-bottom:3px; padding-top:0px; margin: 0px;}
	ol {padding: 0px; padding-bottom:3px; padding-top:0px; margin: 0px;}
	li {padding-left:2px; padding-top:0px; padding-bottom:0px; margin-left:25px;}
	p {margin:2px 0px;}
	span.hilite {background-color:#FFFF00;}
</style>

    <title>Genotype Popup: Part 1, MP Terms</title>
</head>

<body>

<div id="TOC">
	<p>Contents: <a href="#maintitle">Title</a> | <a href="#acceptance">Acceptance Criteria</a> | <a href="#manual">Manual Tests</a> | <a href="#auto">Automated Tests</a></p>
</div>

<div id="maintitle">
    <h1>Genotype Popup Page Tests</h1>
    <ul>
        <li>User story 13, WI: Genotype popup - Part 1</li>
        <li>User story 20, WI: Landing page framework for new genotype popup</li>
    </ul>
</div>

<div id="acceptance">
    <h2>Acceptance Criteria</h2>
	<ul>
		<li>sto13: the data should come from the fewi</li>
		<li>sto13: Looks just like the Public popup page but no images or disease model section</li>
	</ul>
	<ul>
		<li>sto20: genotype framework set up</li>
		<li>sto20: genotype popup now served by fewi</li>
		<li><s>sto20: popup displays a test message</s></li>
	</ul>
</div>



<div id="tests">
    <h2>Tests</h2>
    <p>Skip to <a href="#manual">Manual Tests</a> |  <a href="#auto">Automated Tests</a></p>
	<div id="manual">
<!-- To insert manual test results, use the following:
<p concordion:manual="true">testing assertTrue - displays as green</p>
<p concordion:manual="false">testing assertFalse - displays as red</p>
 -->
		<h3>Manual tests</h3>
		<ol>
    		<li>Verify the data is being generated by the FEWI
 			<p concordion:manual="true">passed. klf 9/18/2012</p>
    		<ol>
                <li>Open the test Web Interface.</li>
                <li>Navigate to the Allele Detail Page for <b>wl</b> (<b>MGI:1856271</b>)</li>
                <li>Open a Genotype Popup window for <b>MGI:3838969</b>  allele pair: <i>wl/wl</i> with genetic background: <i>not specified</i></li>
                <li>Verify the display contains MP Terms and Anatomical System labels. <i>(If any appear, they must be coming from the FEWI.)</i></li>
    		</ol>
    		</li>
    		<li>Verify that an MP term annotated to a genotype that also has annotations to ancestors of the term via different branches in the MP DAG shows up only under the longest annotated ancestor path for a given Anatomical System. 
<!--  			<p concordion:manual="false">new test</p> -->
			<ol>
			    <li>Open the test Web Interface</li>
                <li><span class="hilite">NEED TO FIND A GENOTYPE WITH AN ANNOTATION THAT ALSO CARRIES ANNOTATIONS TO ANCESTORS ALONG 2 DIFFERENT PATHS.</span></li>
                <li>Verify that the MP term <b>WHAT</b> appears below the ancestor term "WHICH 1".</li>
                <li>Verify that the MP term <b>WHAT</b> DOES NOT appear below the ancestor term "WHICH 2".</li>
    		</ol>
    		</li>
    		<li>Verify that each annotated term displays the J-number(s) of the associated reference(s). If more than one, display a comma-delimited list.
 			<p concordion:manual="true">passed. klf 9/18/2012</p>
			<ol>
			    <li>Open the test Web Interface</li>
                <li>Navigate to the Allele Detail Page for <b>wl</b> (<b>MGI:1856271</b>)</li>
                <li>Open a Genotype Popup window for <b>MGI:3838969</b>  allele pair: <i>wl/wl</i> with genetic background: <i>not specified</i></li>
                <li>Verify that <b>nervous system phenotype</b> and its descendant term <b>demyelination</b> each displays  the comma-delimited list: <b>J:13068, J:15162</b>.</li>
                <li>Verify that  clicking each J-number correctly displays its  &quot;References&quot; page.</li>
    		</ol>
    		</li>
    		<li>Verify that the J-number(s) for each annotated term  are linked to the correct Reference page.
 			<p concordion:manual="true">passed. klf 9/18/2012</p>
			<ol>
			    <li>Open the test Web Interface</li>
                <li>Navigate to the Allele Detail Page for <b>wl</b> (<b>MGI:1856271</b>)</li>
                <li>Open a Genotype Popup window for <b>MGI:3838969</b>  allele pair: <i>wl/wl</i> with genetic background: <i>not specified</i></li>
                <li>For <b>nervous system phenotype</b> and its descendant term <b>demyelination</b>, verify that  clicking each J-number correctly displays its  &quot;References&quot; page.</li>
    		</ol>
    		</li>
    		<li>Verify that each Note displays the J-number of the associated reference, and these J-numbers are not linked.
 			<p concordion:manual="true">passed. klf 9/18/2012</p>
			<ol>
			    <li>Open the test Web Interface</li>
                <li>Navigate to the Allele Detail Page for <b>wl</b> (<b>MGI:1856271</b>)</li>
                <li>Open a Genotype Popup window for <b>MGI:3838969</b>  allele pair: <i>wl/wl</i> with genetic background: <i>not specified</i></li>
                <li>Verify that the term <b>demyelination</b> displays two notes.</li>
                <li>Verify that the note beginning &quot;at one week...&quot; displays the J-number <b>J:13068</b>.</li>
                <li>Verify that the note beginning &quot;in the vestibulosponal tract...&quot; displays the J-number <b>J:15162</b>.</li>
                <li>Verify that J-numbers associated with Notes text are <b>not linked</b>.</li>
    		</ol>
    		</li>
    		<li>Verify that Background Sensitivity notes contain that text as a label
 			<p concordion:manual="true">passed. klf 9/18/2012</p>
    		<ol>
    			<li>Naviage to allele Foxb1<sup>tm1Lby</sup>, genotype <b>MGI:3843799</b>  </li>
    			<li>Under <b >reproductive system</b>, for term <b>abnormal milk ejection</b>, verify that the note &quot;females fail to eject milk to feed their young&quot; is preceded by the text <b>Background Sensitivity:</b> (including uppercase and colon)</li>
    		</ol>
    		</li>
    		<li>Verify that the page header contains the correct content
    		<ul>
    			<li>Allele Pair(s)</li>
    			<li>(Genetic) Background (strain)</li>
    			<li>MGI logo</li>
    			<li>Print button</li>
    			<li>Genotype designation (e.g., "hm1") and color bar</li>
    			<!--note genotype designation will be missing the number until rest of allele detail page is implemented (eg hm not hm1) -->
    		</ul>
 			<p concordion:manual="true">passed  jeffc 9/21/2012</p>
    		<ol>
			    <li>Open the test Web Interface</li>
                <li>Navigate to the Allele Detail Page for <b>Del(1Fcgr2b-Fcgr3)1Rav</b> (<b>MGI:5426827</b>)</li>
                <li>Open a Genotype Popup window for <b>MGI:5426844</b></li>
                <li>Verify Allele Pairs:
                	<table>
                		<tr><th>Allele1</th><th>Allele2</th></tr>
                		<tr><td>Del(1Fcgr2b-Fcgr3)1Rav</td><td>Del(1Fcgr2b-Fcgr3)1Rav</td></tr>
                		<tr><td>Fcgr1<sup>tm1Hoga</sup></td><td>Fcgr1<sup>tm1Hoga</sup></td></tr>
                		<tr><td>Tg(FCGR1A)#Jgjw</td><td>0</td></tr>
                		<tr><td>Tg(FCGR2A)11Mkz</td><td>0</td></tr>
                		<tr><td>Tg(FCGR2B)#Rav</td><td>0</td></tr>
                		<tr><td>Tg(FCGR2B)#Rav</td><td>0</td></tr>
                		<tr><td>Tg(FCGR3B)1373Rav</td><td>0</td></tr>
                	</table>
                </li>
                <li>Verify background: <b>involves: 129S1/Sv * C57BL/6 * CBA/Ca * FVB/N</b></li>
                <li>Verify MGI logo and Print button appear</li>
                <li>Verify genotype designation &quot;tg1&quot; and <b>pink</b> color bar appear</li>
                <!--note genotype designation will be missing the number until rest of allele detail page is implemented (eg hm not hm1) -->
    		</ol>
    		</li>
		</ol>
	</div>
	<div id="auto">
		<h3>Automated tests</h3>
		<ol>
		<li>Verify that terms appearing in multiple systems do.
    		<ol>
    			<li>for genotype Braf<sup>tm1Bbd</sup>/Braf<sup>+</sup> (<b concordion:set="#gid">MGI:4946647</b>)
    					each Term appears under the specified Anatomical System:
	    			<table concordion:execute="#terms = getTermsForSystem(#gid,#system)">
		                <tr><th concordion:set="#system">Anatomical System</th><th cc:assertValueAppearsOnlyOnce="#terms">Term</th></tr>
						<tr><td>behavior/neurological</td><td>convulsive seizures</td></tr>
						<tr><td>cardiovascular system</td><td>increased cardiac muscle contractility</td></tr>
						<tr><td>cellular</td><td>increased thymocyte apoptosis</td></tr>
						<tr><td>craniofacial</td><td>abnormal frontal bone morphology</td></tr>
						<tr><td>digestive/alimentary system</td><td>abnormal pancreatic acinar cell morphology</td></tr>
						<tr><td>endocrine/exocrine glands</td><td>abnormal pancreatic acinar cell morphology</td></tr>
						<tr><td>hematopoietic system</td><td>decreased thymocyte number</td></tr>  	
						<tr><td>immune system</td><td>decreased thymocyte number</td></tr>
						<tr><td>integument</td><td>abnormal dermal melanocyte morphology</td></tr>
						<tr><td>muscle</td><td>increased cardiac muscle contractility</td></tr>
						<tr><td>nervous system</td><td>convulsive seizures</td></tr>
						<tr><td>pigmentation</td><td>abnormal dermal melanocyte morphology</td></tr> 
						<tr><td>skeleton</td><td>abnormal frontal bone morphology</td></tr>
	                </table>
                </li>
    		</ol>
    		</li>
    		<li>Verify that Anatomical Systems appear in the order specified by the curator.
    		<ol>
    			<li>verify that for genotype Braf<sup>tm1Bbd</sup>/Braf<sup>+</sup> (<b concordion:set="#gid">MGI:4946647</b>)
    					the following systems appear in this order
	    			<table concordion:verifyRows="#system : getSystems(#gid)">
		                <tr><th concordion:assertEquals="#system">Anatomical System</th></tr>
		                <tr><td>mortality/aging</td></tr>
						<tr><td>craniofacial</td></tr>
						<tr><td>growth/size/body</td></tr>
						<tr><td>behavior/neurological</td></tr>
						<tr><td>cardiovascular system</td></tr>
						<tr><td>vision/eye</td></tr>
						<tr><td>tumorigenesis</td></tr>
						<tr><td>integument</td></tr>
						<tr><td>cellular</td></tr>
						<tr><td>immune system</td></tr>
						<tr><td>adipose tissue</td></tr>
						<tr><td>endocrine/exocrine glands</td></tr>
						<tr><td>renal/urinary system</td></tr>
						<tr><td>respiratory system</td></tr>
						<tr><td>nervous system</td></tr>
						<tr><td>pigmentation</td></tr> 
						<tr><td>muscle</td></tr>
						<tr><td>skeleton</td></tr>
						<tr><td>digestive/alimentary system</td></tr>
						<tr><td>hematopoietic system</td></tr>  	
	                </table>
                </li>
    		</ol>
    		</li>
    		<li>Verify that all possible Note Types for MP Annotations can be displayed
    		<ul>
    			<li>General note</li>
    			<li>Background Sensitivity note</li>
    			<li>Normal note</li>
    		</ul>
    		<ol>
                <li>Navigate to the Allele Detail Page for <b>Foxb1<sup>tm1Lby</sup></b> (<b>MGI:2384415</b>)</li>
                <li>For Genotype <b concordion:set="#gid">MGI:3843796</b> (hm2), 
                	under <b concordion:set="#system">reproductive system</b> 
                	for term abnormal milk ejection (<b concordion:set="#termID">MP:0003838</b>)</li>
                <li>Verify note type <b>Background Sensitivity</b> with content 
                	&quot;<b cc:assertValueAppearsOnlyOnce="getNotesByTermIgnoreSystem(#gid,#termID)">Background Sensitivity: females fail to eject milk to feed their young</b>&quot; exists</li>
 				<li>Also verify note with no initial label exists: &quot;<b cc:assertValueAppearsOnlyOnce="getNotesByTermIgnoreSystem(#gid,#termID)">lactation can often be restored by oxytocin injection</b>&quot;</li>
 				<li>Navigate to the Allele Detail Page for <b>Ty</b> (<b>MGI:1856639</b>)</li>
 				<li>Open a Genotype Popup window for <b concordion:set="#gid">MGI:2654844</b>,
 					under <b concordion:set="#system">nervous system</b></li>
 				<li>Below the term &quot;<b concordion:set="#term">nervous system phenotype</b>&quot; 
 					verify note with no initial label (has note type <b>Normal</b> in the database) exists: 
 					&quot;<b cc:assertValueAppearsOnlyOnce="getNotesByTerm(#gid,#system,#term)">normal myelination</b>&quot;</li>
 				<li>Navigate to the Allele Detail Page for <b>Mecp2<sup>tm1Bird</sup></b> (<b>MGI:2137555</b>)</li>
 				<li>Open a Genotype Popup window for <b concordion:set="#gid">MGI:3817462</b>,
 					under <b concordion:set="#system">behavior/neurological</b></li>
 				<li>Below the term &quot;<b concordion:set="#term">behavior/neurological phenotype</b>&quot;
 				<ul>
 					<li>Verify note type <b>Background Sensitivity</b> with content 
 					&quot;<b cc:assertValueAppearsOnlyOnce="getNotesByTerm(#gid,#system,#term)">Background Sensitivity: no overt abnormalities are observed; mutants do not exhibit impaired coordination in a variety of tests measured</b>&quot; </li>
 					<li>Verify note with no initial label (has note type <b>Normal</b> in the database) exists: 
 					&quot;<b cc:assertValueAppearsOnlyOnce="getNotesByTerm(#gid,#system,#term)">mice do not show overt abnormalities like tremor or limb grasping</b>&quot;</li>
 				</ul>
 				</li>
 				<li>Verify that long notes have their text displayed in the proper order (from NoteChunks in our Sybase database)</li>
 				<li>verify that for genotype wl/wl (<b concordion:set="#gid">MGI:3838969</b>)
    					that the correct notes are displayed.</li>
    			<li> for <b concordion:set="#system">nervous system</b> the term <b concordion:set="#term">demyelination</b>
    				should have the following notes:
	    			<table cc:verifyRowsUnordered="#notes : getNotesByTerm(#gid,#system,#term)">
		                <tr><th concordion:assertEquals="#notes">Note</th></tr>
		                <tr><td>at one week of age a small amount of myelin degeneration can be found in the ventral funiculus of the spinal cord; at two weeks of age myelin degeneration is marked in the vestibulo-spinal tracts and beginning in the spino-cerebellar tracts; and by 2.5 weeks of age very severe demyelination is found throughout the archi- and paleocerebellar systems, with heavy degeneration permeating the vestibulo-spinal tract, dorsal spinocerebellar tract, brachium conjunctivum, magnocellular red nucleus, rubrospinal tract, vestibular nerve and nuclei, juxtarestiform body, trapezoid body and the superior olivary nucleus, and moderate degeneration in the medial lemnicus, medial longitudinal fasiculus and tecto-spinal tracts</td></tr>
						<tr><td>in the vestibulosponal tract from the lateral vestibular nucleus to the spinal cord, and in the entering fibers of the eighth cranial nerve, the juxtaresiform body, the medullary center of the cerebellum, the medial longitudinal fasciculus, the trapezoid body, the lateral lemniscus, brachium conjunctivum, red nucleus, and the rubrospinal and tectospinal tracts</td></tr>
	                </table>
                </li>
 			</ol>
 			
    		</li>
    		<li>Verify that genotypes with "norm" annotations display correctly in the Geno-Pheno popup
    		<ol>
                <li>For genotype <b concordion:set="#gid">MGI:3838969</b>  allele pair: <i>wl/wl</i> with genetic background: <i>not specified</i></li>
                <li>Verify that for each Anatomical System below, the highest-level term is displayed (indicating a "normal" annotation within that System)
                <table concordion:execute="#terms = getTermsForSystem(#gid,#system)">
                	<tr><th concordion:set="#system">Anatomical System</th><th cc:assertValueAppearsOnlyOnce="#terms">Term</th></tr>
                	<tr><td>nervous system</td><td>nervous system phenotype</td></tr>
                	<tr><td>behavior/neurological</td><td>behavior/neurological phenotype</td></tr>
                	<tr><td>hearing/vestibular/ear</td><td>hearing/vestibular/ear phenotype</td></tr>
                </table>
                </li>
    		</ol>
    		</li>
    		<li>Verify that each annotated term displays the J-number(s) of the associated reference(s).
			<ol>
                <li>For genotype <b concordion:set="#gid">MGI:3838969</b>  allele pair: <i>wl/wl</i> with genetic background: <i>not specified</i></li>
                <li>Verify that under <b concordion:set="#system">nervous system</b>, 
                	<b concordion:set="#term">nervous system phenotype</b> displays the following jnum IDs:
                	<table cc:verifyRowsUnordered="#jnum : getTermJnumsBySystem(#gid,#system,#term)">
                		<tr><th concordion:assertEquals="#jnum">Jnum ID</th></tr>
                		<tr><td>J:13068</td></tr>
                		<tr><td>J:15162</td></tr>
                	</table>
                </li>
                <li> Also verify that its descendant term <b concordion:set="#term">demyelination</b> also displays  the following Jnum IDs:
                	<table cc:verifyRowsUnordered="#jnum : getTermJnumsBySystem(#gid,#system,#term)">
                		<tr><th concordion:assertEquals="#jnum">Jnum ID</th></tr>
                		<tr><td>J:13068</td></tr>
                		<tr><td>J:15162</td></tr>
                	</table>
                </li>
    		</ol>
    		</li>
    		<li>Verify that genotypes with "no phenotypic analysis" display correctly in the Geno-Pheno popup
    		<ol>
    			<li>see the only genotype for <b>Ahr<sup>b-3</sup> (MGI:2667538)</b> - 
    				genotype ID: <b concordion:set="#gid">MGI:3776519</b></li>
    			<li>Anatomical System heading: <b concordion:set="#system">phenotype not analyzed</b></li>
    			<li>Anatomical Term: <b concordion:set="#term">no phenotypic analysis</b></li>
    			<li>Note text: <b cc:assertValueAppearsOnlyOnce="getNotesByTerm(#gid,#system,#term)">no phenotypic analysis on this allele is currently available</b></li>
    		</ol>
    		</li>
		</ol>
 <!--  EXAMPLE TEST CASE USING DYNAMIC DATA SPREADSHEET AT https://docs.google.com/spreadsheet/ccc?key=0ArepxibBtJW2dEl0eEg1bElOc1Mxc1FnNGtmSmlUSlE#gid=2 
     			<li>
    			Query for <b concordion:set="#structure">4-cell stage</b> should return 
    			<b cc:assertEquals="getResultCount(#structure)"><b cc:dynamicData="countFor4CellStageResults"></b></b> assay results, 
    			<b cc:assertEquals="getAssayCount(#structure)"><b cc:dynamicData="countFor4CellStageAssays"></b></b> assays, 
    			and <b cc:assertEquals="getGeneCount(#structure)"><b cc:dynamicData="countFor4CellStageGenes"></b></b> genes.<br/></li>
  -->
 	</div>
</div>

</body>
</html>